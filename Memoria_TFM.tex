%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% >>>>>>>>>>> EMPIEZA PREÁMBULO <<<<<<<<<<< %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass[12pt,a4paper,titlepage,twoside]{book}
\usepackage[american]{babel}	% Idioma en castellano. que ls tablas se llamen tablas
\usepackage{amsmath}		% Proporciona símbolos matemáticos de la American Mathematical Society
\usepackage{amssymb}
\usepackage{latexsym}		% Símbolos
\usepackage{eurosym}       % para el símbolo del euro
\usepackage{fancyhdr}		% Cabecera y pie de página
\usepackage{titlesec}		% Aspecto configurable de los capítulos
\usepackage{longtable}		% Permite las tablas que ocupan más de una página
\usepackage{anysize}		% Configuración de márgenes
\usepackage{color}			% Colores
\usepackage{graphicx}		% Gestión de imágenes
\usepackage{wrapfig}
\usepackage{afterpage}
\usepackage{epsfig}			% Entiende EPSs
\usepackage{epstopdf}		% Entiende EPSs
\DeclareGraphicsExtensions{.eps,.ps,.pdf}
\usepackage{hyperref}       %Vínculos
\usepackage{subfigure}		% Subfiguras
\usepackage{minitoc}		% Indice por capítulo #1
\dominitoc					% Indice por capítulo #2
\usepackage{tocbibind}		% Incluir figuras, tablas, referencias e índice a éste
\usepackage{pdfpages}		% Incluir PDFs
\usepackage{anysize}		%Cambiar los margenes
\usepackage{cite}

\usepackage{enumitem}		%Para incluir listas no numeradas.
\renewcommand{\labelitemi}{$-$} %Para cambiar los símbolos de una lista no enumerada
\renewcommand{\labelitemii}{$\cdot$}%Para cambiar los símbolos de una lista no enumerada
\usepackage{titlesec}
\usepackage{placeins} %Para Mostrar imagenes almacenadas en cada sección.
%\usepackage{caption} %Cambiar el pie de foto
\usepackage[font={small,it}]{caption}
\usepackage{color} %Colores

%Paquetes para tablas
\usepackage[table,xcdraw]{xcolor}
\usepackage{array}
\usepackage{booktabs} %cambiar ancho de las líneas
% Arreglar el bug de \titlesec que no seme enumeraban las secciones
\usepackage{etoolbox}

\makeatletter
\patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}
\patchcmd{\ttlh@hang}{\noindent}{}{}{}
\makeatother



%Cabecera y pie de pagina
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagestyle{fancy}
\fancyhf{}
%\fancyhead[RO]{\leftmark} % En las páginas impares, parte izquierda del encabezado, aparecerá el nombre de capítulo
\fancyhead[LE]{\leftmark} % En las páginas pares, parte derecha del encabezado, aparecerá el nombre de sección
\fancyhead[LO,RE]{\thepage} % Números de página en las esquinas de los encabezados
\renewcommand{\chaptermark}[1]{\markboth{\textbf{\thechapter. #1}}{}} % Formato para el capítulo: N. Nombre
\renewcommand{\sectionmark}[1]{\markright{\textbf{\thesection. #1}}} % Formato para la sección: N.M. Nombre
\renewcommand{\headrulewidth}{0.4pt} % Ancho de la línea horizontal bajo el encabezado
\renewcommand{\footrulewidth}{0.2pt} % Ancho de la línea horizontal sobre el pie
\setlength{\headheight}{1.5\headheight} % Aumenta la altura del encabezado en una vez y media
\newcommand{\Keywords}[1]{\vfill\noindent{\small{\em Palabras clave}: #1}}
\definecolor{grisclar}{gray}{0.5}
\definecolor{grisfosc}{gray}{0.25}
\newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\}

\makeatletter %Para que al final de cada parte se reanude la numeración de capitulos por 1
\@addtoreset{chapter}{part}
\makeatother

\urlstyle{same}

% Título, autor y fecha del documento
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{\Huge \textbf{`Learning convolutional Neural Network for Face Anti-Spoofing''}}
\author{\Huge \textit{Beatriz G\'omez Ayll\'on}}



% Referencias internas
%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\fullref}[1]{\ref{#1} de la página \pageref{#1}}

% Insertar página en blanco
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\blankpage}{
\newpage \thispagestyle{empty}
\emph{  }
\newpage
}


% Elimina la cabecera de la última página vacía del capítulo
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else%
   \hbox{}
   \thispagestyle{empty}	% Elimina estilo cabeceras y "plain" enumera la página como la siguiente
   \newpage
   \if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% >>>>>>>>>> FINAL DEL PREÁMBULO <<<<<<<<<< %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% >>>>>>>>>>> EMPIEZA LO BUENO <<<<<<<<<<<< %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

\mtcaddchapter % Para que el minitock salga bien

\frontmatter
%margen del documento
\marginsize{3.0cm}{2.0cm}{3.5cm}{2.5cm}


%%%%%%%%%%%%%%%% PORTADA %%%%%%%%%%%%%%%%%%
%\includepdf[pagecommand={\thispagestyle{empty}}]{media/portada.pdf}

%\blankpage

%\blankpage % Primera pagina
%\blankpage % Primera pagina - reverso


%%%%%%%%%%%%%%%%% ACTA %%%%%%%%%%%%%%%%%%%%%
%\includepdf[pagecommand={\thispagestyle{empty}}]{media/Acta.pdf}
%\blankpage %reverso del acta


\maketitle
%\blankpage %reverso titulo

%%%%%%%%%%%%%%%% DEDICATORIA %%%%%%%%%%%%%%
%\input{dedicatoria.tex}
%\blankpage %reverso

%%%%%%%%%%%%%%%% AGRADECIMIENTOS %%%%%%%%%%%%%%%%%%
%\chapter*{Agradecimientos}
%	\input{agradecimientos}
%\blankpage %reverso


\chapter*{Abstract}
This thesis proposes an algorithm based on Deep Learning whose finality is being able to detect face spoofing attacks.\\

CASIA, FRAV and MFSD-MSU databases would be used in the entire document for each experiment. Each database is constituted by face images of genuine users and different spoofing attacks on people. Spoofing images nature could be printed photos, masks and photos or videos displayed on a smartphone or tablet device of genuine users.\\

With the purpose of getting the main objective, a Convolutional Neural Network (CNN) would be designed and build for this specific problem. Furthermore, the best suitable classifier would be discussed and selected.\\

The Convolutional Neural Network architecture would be developed from LeNet-5 architecture. The steps and decision made to get the final architecture of the Convolutional Neural Network are explained likewise the personalization of each classifier.\\

 Images of databases would be used to feed the input of the CNN. The features obtained at the output of the CNN would be used as the input for training and testing classifiers. The selected classifiers which would be used are K-Nearest Neighbors (KNN), Support Vector Machine (SVM), Decision Tree and Logistic regression. Additionally, reduction algorithm methods as LDA and PCA are utilized with each classifier.\\

Classifiers and dimensionality reduction algorithms would be personalized for each database and each experiment.\\

Python has been used to succeed the thesis object as the programming language. Theano has been preferred as the main library to develop the convolutional neural network architecture and training and testing processes.\\

From the results obtained, could be concluded that the most correctly classified database is RGB+NIR (added in feature level) FRAV database by reason of the perfectly classification result.\\



\input{agradecimientos.tex}


%%%%%%%%%%%%%%% ÍNDICE %%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents %Tabla con el Indice

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%% MEMORIA %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\mainmatter
%\part{MEMORY}
\chapter{Introduction}\label{ch:introduction}
  \input{Intro.tex}
\chapter{Literature Review}\label{ch:review}
	\input{related_work.tex}
\chapter{Background Theory}\label{theorics}
  \input{theory.tex}
\chapter{Methodology} \label{ch:methodology}
  \input{methodology.tex}
\chapter{Experiments} \label{experiments}
  \input{summary.tex}
\chapter{Results} \label{ch:results}
	\input{results.tex}

\chapter{Conclusions and future work} \label{ch:concl}
  \input{conoclusion.tex}

\bibliographystyle{ieeetr}
\bibliography{references}


%\chapter{Anexos}
%\fancyhead[RO]{} %Encabezado paginas impares con \part
%\listoffigures 	%indice de imágenes
%\blankpage
%\listoftables
%\blankpage







\end{document}
